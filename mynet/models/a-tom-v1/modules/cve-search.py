import requests, sys
from colors import *

def buscar_CVE(cve_id):
    url = f"https://cve.circl.lu/api/cve/{cve_id}"
    response = requests.get(url)
    
    if response.status_code == 200:
        data = response.json()
        return data
    elif response.status_code == 404:
        return None
    else:
        raise Exception(f"Error al buscar CVE: {response.status_code}")


if __name__ == '__main__':
    if len(sys.argv) != 2:
        print(f"Uso: python {sys.argv[0]} <CVE-ID>")
        sys.exit(1)
    cve_id = sys.argv[1]
    resultado = buscar_CVE(cve_id)
    if resultado is None:
        print(f"La CVE {cve_id} no existe.")
    else:
        print(f"Información de la CVE {cve_id}:")
        print("Descripción:", resultado["summary"])
        print("CVSS Score:", resultado["cvss"])